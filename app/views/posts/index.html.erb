
<!DOCTYPE html>
<html lang="en">
  <title>The name of your site</title>
  
    <%= stylesheet_link_tag 'style' %>
    <%= javascript_include_tag 'interface' %> 
    <%= csrf_meta_tags %>
<body>
  <header>
<%= render 'layouts/navbar' %>
  </header>

  <main>
    <%if current_user %>
    <div class ='all_posts'>
      <div id ='new-post'>
    
        <div class ='new-post__form'><%= render j 'form' %></div>
      </div>
      <% @posts.reverse.each do |post| %>
        <div class ='post'>          
        <%# <%= image_tag(@user.avatar_thumbnail) if @user.avatar.attached? %> 
          <div class ='post_header'>
           <% if post.user.avatar.attached? %>
            <%= image_tag(post.user.avatar_thumbnail)%>
            <% else %>
            <%= image_tag("default_image.jpg") %>
            <% end  %>
            <div class ='post_header-name'><%= post.user.firstname%> <%= post.user.lastname%></div>
            <div><%= post.created_at.to_formatted_s(:time) %></div>
          </div>
      
          <p class ='post__message'><%= post.message %></p>

          <div class ='post__footer-info'>
            <div><%= post.likes %> <i style ='color: rgb(226, 30, 30)' class="fas fa-heart"></i></div>
            <% if post.comments.length == 1 %>
              <div><%= post.comments.length %> <%= link_to "Comment", post, remote: true %></div>
            <% else %>
            <div><%= post.comments.length %> <%= link_to "Comments", post, remote: true %></div>
            <% end %>
          </div>

          <div class ='post_footer'>
            <p  class ='post__footer-el'>
              <a href="/posts/<%= post.id %>/like"><i style ='color: #ddd' class="fas fa-heart"></i>     Like</a>
            </p>
            <p class ='post__footer-el'><%= link_to "Comment", post, class: 'post__footer-el', remote: true %></p>
            <% if post.user == current_user %>
              <p class ='post__footer-el delete'><%= link_to "Delete", post_path(post), method: :delete %></p>
            <% else %>
              <p class ='post__footer-el delete'>Delete</p>
            <% end %>
          </div>
          <div class= 'post__comments' id ='<%=post.id%>'></div>
        </div>
      <% end %>
     
    </div>
  </main>

  <div class= 'post__comments'></div>
  
  <% else %>
    <h1>Sign in to view this page.</h1>
  <% end %>
</body>
</html>
